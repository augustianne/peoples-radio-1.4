<?php


/**
 * Skeleton subclass for performing query and update operations on the 'community' table.
 *
 * 
 *
 * This class was autogenerated by Propel 1.4.2 on:
 *
 * Fri Jun 22 14:57:06 2012
 *
 * You should add additional methods to this class to meet the
 * application requirements.  This class will only be generated as
 * long as it does not already exist in the output directory.
 *
 * @package    lib.model
 */
class CommunityPeer extends BaseCommunityPeer {

	public static function prunePlaylist(Channel $channel=null){
		sfProjectConfiguration::getActive()->loadHelpers('MPD');
		$file = mpd_get_current_track_info($channel->getPort(), 'file');
		$c = new Criteria();
		$c->add(TrackPeer::FILENAME, trim($file));

		$track = TrackPeer::doSelectOne($c);

		if($track){
			$communityTrack = CommunityPeer::retrieveByPK($track->getId(), $channel->getId());
			if($communityTrack)
				$communityTrack->delete();
		}
	}

} // CommunityPeer
